<% flash.each do |type, msg| %>
  <div class='player-list__error'>
    <%= msg %>
  </div>
<% end %>

<div class='player-list'>
  <div class='player-list__resources'>
    <% @players.each do |player| %>
      <div class="player-list__player">      
        <div>
          <span class="player-list__player-name">
            <%= player.name %>
          </span>
          <%= button_to "Draw", { action: "draw", player_id: player.id }  %>
          <p>Hand size: <%= player.hand_size %></p>
          <p>Development cards: <%= player.cards.where(played_at: nil).count %></p>
        </div>

        <%= form_with(url: "/players/#{player.id}/give", method: :post, class: 'player-list__resource-form') do %>
          <div>
            <div>
              <%= label_tag(:brick, 'Brick:', class: 'player-list__resource-label') %>
              <%= number_field_tag(:brick, 0, class: 'player-list__resource-field') %>
            </div>
            <div>
              <%= label_tag(:grain, 'Grain:', class: 'player-list__resource-label') %>
              <%= number_field_tag(:grain, 0, class: 'player-list__resource-field') %>
            </div>
            <div>
              <%= label_tag(:lumber, 'Lumber:', class: 'player-list__resource-label') %>
              <%= number_field_tag(:lumber, 0, class: 'player-list__resource-field') %>
            </div>
            <div>
              <%= label_tag(:ore, 'Ore:', class: 'player-list__resource-label') %>
              <%= number_field_tag(:ore, 0, class: 'player-list__resource-field') %>
            </div>
            <div>
              <%= label_tag(:wool, 'Wool:', class: 'player-list__resource-label') %>
              <%= number_field_tag(:wool, 0, class: 'player-list__resource-field') %>
            </div>
          </div>
          <div>
            <%= submit_tag('Give/Take resources', class: 'player-list__give-button' ) %>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>

  <div class='player-list__game-info'>
    <div>    
      <h2>Bank</h2>
      <ul>
        <li>Brick: <%= @brick_left_in_bank %></li>
        <li>Grain: <%= @grain_left_in_bank %></li>
        <li>Lumber: <%= @lumber_left_in_bank %></li>
        <li>Ore: <%= @ore_left_in_bank %></li>
        <li>Wool: <%= @wool_left_in_bank %></li>
      </ul>
    </div>

    <%= form_with(url: "/trade", method: :post) do %>
      <h2>Trade</h2>
      <div>
        <%= select("trade", 'player_1_id', Player.all.collect {|p| [ p.name, p.id ] }, { include_blank: true }) %>            
        <div>
          <%= label_tag(:player_1_brick, 'Brick:') %>
          <%= number_field_tag(:player_1_brick, 0) %>
        </div>
        <div>
          <%= label_tag(:player_1_grain, 'Grain:', ) %>
          <%= number_field_tag(:player_1_grain, 0) %>
        </div>
        <div>
          <%= label_tag(:player_1_lumber, 'Lumber:',) %>
          <%= number_field_tag(:player_1_lumber, 0) %>
        </div>
        <div>
          <%= label_tag(:player_1_ore, 'Ore:') %>
          <%= number_field_tag(:player_1_ore, 0) %>
        </div>
        <div>
          <%= label_tag(:player_1_wool, 'Wool:') %>
          <%= number_field_tag(:player_1_wool, 0) %>
        </div>
      </div>

      <div>
        <%= select("trade", 'player_2_id', Player.all.collect {|p| [ p.name, p.id ] }, { include_blank: true }) %>            
        <div>
          <%= label_tag(:player_2_brick, 'Brick:') %>
          <%= number_field_tag(:player_2_brick, 0) %>
        </div>
        <div>
          <%= label_tag(:player_2_grain, 'Grain:', ) %>
          <%= number_field_tag(:player_2_grain, 0) %>
        </div>
        <div>
          <%= label_tag(:player_2_lumber, 'Lumber:',) %>
          <%= number_field_tag(:player_2_lumber, 0) %>
        </div>
        <div>
          <%= label_tag(:player_2_ore, 'Ore:') %>
          <%= number_field_tag(:player_2_ore, 0) %>
        </div>
        <div>
          <%= label_tag(:player_2_wool, 'Wool:') %>
          <%= number_field_tag(:player_2_wool, 0) %>
        </div>
      </div>
 
      <%= submit_tag('Trade') %>
    <% end %>

    <div>
      <h2>Steal card</h2>
      <%= form_with(url: "/steal", method: :post) do %>
        <%= select("steal", 'thief_id', Player.all.collect {|p| [ p.name, p.id ] }, { include_blank: true }) %>
        is stealing from
        <%= select("steal", 'victim_id', Player.all.collect {|p| [ p.name, p.id ] }, { include_blank: true }) %>
        <%= submit_tag('steal') %>
      <% end %>
    </div>

    <h2>Played cards: </h2>
    <% Card.where.not(played_at: nil).order(played_at: :desc).each do |card| %>
      <div>
        <p><%= card.name %></p>
        <%= image_tag(card.image_url, width: 100) %>
        <p><%= Player.find(card.player_id).name %></p>
        <p><%= card.played_at %></p>
        <p>==========================</p>
      </div>
    <% end %>
  </div>
</div>


